{% extends 'base.html' %}

{% block viz %}
<!DOCTYPE html>
<!-- <html>
<head>
    <title>ElasticSearch into NVD3.js demo</title>

    <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/novus/nvd3/v1.8.1/build/nv.d3.css">

    <script src="../../_viz_streamer"></script>

    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="https://cdn.rawgit.com/novus/nvd3/v1.8.1/build/nv.d3.min.js"></script>

    <style>
        #chart svg {
            height: 400px;
        }
    </style>

</head> -->
<body>
<script>
var data;

d3.json('http://localhost:5000/_viz_streamer', function(error, json) {
    if (error) return console.warn(error);
    data = json;

    height = 960;
    width = 540;

    nv.addGraph(function() {
        var chart = nv.models.pieChart()
            .x(function(d) {return d.key})
            .y(function(d) {return d.doc_count})
            .showLabels(true);

        d3.select("#chart svg")
            .datum(data)
            .transition().duration(350)
            .call(chart);

        nv.utils.windowResize(chart.update);
        return chart;
    });
});
</script>

<div id="searchbar">
    <form method="GET" action="."></form>
</div>

<div id="chart"><svg></svg></div>

</body>
</html>
{% endblock %}